# Deny all direct access to uploaded files
# Files should only be served through PHP for security

# Disable directory indexing
Options -Indexes

# Disable script execution
Options -ExecCGI
RemoveHandler .php .php3 .php4 .php5 .phtml .pl .py .cgi

# Disable PHP execution in this directory
<FilesMatch "\.php$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# Allow access to logo and favicon (branding files)
<FilesMatch "^(logo\.png|favicon\.ico)$">
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Allow from all
    </IfModule>
</FilesMatch>

# Deny all other files by default
<FilesMatch "^(?!(logo\.png|favicon\.ico)$).*">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>
